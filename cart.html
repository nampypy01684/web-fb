<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
    <link rel="stylesheet" href="./css/mainstyle.css">
    <title>Giỏ hàng của bạn VOXFootball</title>
</head>

<body>
    <secsion class="top">
        <div class="container">
            <div class="row">
                <div class="top-logo">
                    <a href="index.html"><img src="./images/logoShop.png" alt="" height="69px" width="80px"></a>
                </div>
                <div class="top-menu-items">
                    <ul>
                        <li><a href="index.html">Trang chủ</a></li>
                        <li>Áo CLB
                            <ul class="top-menu-item">
                                <li>
                                    <a href="cartegory-nha.html">Ngoại Hạng Anh</a>
                                </li>
                                <li>
                                    <a href="cartegory-laliga.html">Laliga</a>
                                </li>
                                <li>
                                    <a href="cartegory-seria.htm">SeriA</a>
                                </li>
                                <li>
                                    <a href="cartegory-l1.html">Leuge 1</a>
                                </li>
                            </ul>
                        </li>
                        <li>Áo Đội Tuyển Quốc Gia
                            <ul class="top-menu-item">
                                <li>
                                    <a href="cartegory-ca.html">Châu Á</a>
                                </li>
                                <li>
                                    <a href="cartegory-cau.html">Châu ÂU</a>
                                </li>
                                <li>
                                    <a href="cartegory.cmi.html">Châu Mĩ</a>
                                </li>
                            </ul>
                        </li>
                        <li>Giày</li>
                        <li>Phụ kiện
                            <ul class="top-menu-item">
                                <li><a href="cartegory-gloves.html">Găng tay thủ môn</a></li>
                                <li><a href=""> Vải quấn chân</a></li>
                                <li><a href="cartegory-socks.html">Tất chống trơn</a></li>
                                <li><a href="">Băng keo</a></li>
                                <li><a href="cartegory-helmet.html">Nón bảo hộ</a></li>
                            </ul>
                        </li>
                        <li><a href="news.html">Tin tức</a></li>
                        <li><a href="lienhe.html">Liên hệ</a></li>
                    </ul>
                </div>
                <div class="top-menu-icons">
                    <ul>
                        <li>
                            <input type="text" placeholder="Tìm kiếm">
                            <i class="fas fa-search"></i>
                        </li>
                        <li>
                            <i class="fas fa-user"></i>
                        </li>
                        <li>
                            <i class="fas fa-shopping-cart"></i>
                            <p class="cartNo">0</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </secsion>
    <!-------------------giỏ hàng------------------- -->
    <div class="cart">
        <div class="container">
            <div class="process">
                <div class="cart-top-process">
                    <div class="cart-top-car cart-top-item">
                        <i class="fas fa-shopping-cart"></i><br>
                        <span>Giỏ hàng</span>
                    </div>
                    <div class="cart-top-address cart-top-item">
                        <i class="fas fa-map-marker-alt"></i><br>
                        <span>Đặt hàng</span>
                    </div>
                    <div class="cart-top-payment cart-top-item">
                        <i class="far fa-credit-card"></i><br>
                        <span>Thanh toán</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="cart-container row">
                <div class="cart-container-left">
                    <table id="tblCart" >

                       
                    </table>
                </div>
                <div class="cart-container-right">
                    <table>
                        <tr>
                            <th colpan="2">TỔNG TIỀN GIỎ HÀNG</th>
                        </tr>
                        <tr>
                            <td>Tổng sản phẩm</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>Tổng tiền hàng</td>
                            <td>
                                <p>120.000<sup>đ</sup></p>
                            </td>
                        </tr>
                        <tr>
                            <td>Thành tiền</td>
                            <td>
                                <p>120.000<sup>đ</sup></p>
                            </td>
                        </tr>
                        <tr>
                            <td>Tạm tính</td>
                            <td>
                                <p style="color:black; font-weight: bold;">120.000</p><sup>đ</sup>
                            </td>
                        </tr>
                    </table>
                    <div class="cart-container-right-text">
                        <p style="color:red; font-weight: bold;">Miễn đổi trả đối với sản phẩm đồng giá / sale trên 10%
                        </p>
                    </div>
                    <div class="cart-container-right-button">
                        <a href="index.html"><button class="tieptucmuasam">TIẾP TỤC MUA SẮM</button></a>
                        <a href="delivery.html"> <button class="delivery">ĐẶT HÀNG</button> </a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!----------------------- Footer------------------------------------ -->
    <section class="footer">
        <div class="footer-container">
            <p>Tải ứng dụng VOXFootball</p>
            <div class="app-google">
                <a href=""><img src="./images/appstore.png" alt=""></a>
                <a href=""> <img src="./images/googleplay.png" alt=""></a>
            </div>
            <p>Nhận tin tức mới nhất từ VOXFootball</p>
            <div class="input-email">
                <input type="text" placeholder="Nhập email của bạn">
                <i class="fas fa-arrow-left"></i>
            </div>
            <div class="footer-items">
                <li><a href=""><img src="./images/dathongbao.png" alt=""></a></li>
                <li><a href="">Liên hệ</a></li>
                <li><a href="">Tuyển dụng</a></li>
                <li><a href="">Giới thiệu</a></li>
                <li><a href=""><i class="fab fa-facebook-f"></i></a><a href=""><i class="fab fa-youtube"></i></a></li>
            </div>
            <div class="footer-text">
                <h3>VOXFootball Offical</h3>
                <b>Địa chỉ: </b>70 Tô Ký, Tân Chánh Hiệp, Quận 12, Hồ Chí Minh <br>
                <b>Mail: </b>voxfootballvn@gmail.com <br>
                <b>Đặt hàng online:</b>0981772800

            </div>
            <div class="footer-bottom">
                ©VOXFootball All rights reserved
            </div>
        </div>
    </section>


    <script src="js/script.js"></script>
    <script src="js/slider.js"></script>
    <script src="js/nha.js"></script>


</body>

</html>
<script>
   document.addEventListener("DOMContentLoaded", function () {
    // Lấy số lượng sản phẩm từ localStorage
    let soluong = localStorage.getItem("totalQty");

    // Nếu không có giá trị, đặt nó là 0
    if (!soluong) {
        soluong = 0;
    }

    // Hiển thị số lượng trên trang
    document.querySelector(".cartNo").innerText = soluong;

    // Lấy thông tin giỏ hàng từ localStorage
    let arrCart = JSON.parse(localStorage.getItem("myCart")) || [];
    console.log(arrCart);

    // Tạo bảng giỏ hàng
    let strHeader = `<tr>
                        <th>Sản Phẩm</th>
                        <th>Tên Sản Phẩm</th>
                        <th>Size</th>
                        <th>Số lượng</th>
                        <th>Thành tiền</th>
                        <th>Xóa</th>
                    </tr>`;

    let strData = "";
    arrCart.forEach((item, index) => {
        strData += `<tr data-index="${index}">
                        <td><img src="${item.sp.hinh}" alt="${item.sp.ten}" width="100"></td>
                        <td>
                            <p>${item.sp.ten}</p>
                        </td>
                        <td>
                            <select class="sizeSelect">
                                <option value="S" ${item.size === "S" ? "selected" : ""}>S</option>
                                <option value="M" ${item.size === "M" ? "selected" : ""}>M</option>
                                <option value="L" ${item.size === "L" ? "selected" : ""}>L</option>
                                <option value="XL" ${item.size === "XL" ? "selected" : ""}>XL</option>
                                <option value="XXL" ${item.size === "XXL" ? "selected" : ""}>XXL</option>
                            </select>
                        </td>
                        <td><input type="number" class="qtyInput" value="${item.qty}" min="1"></td>
                        <td class="itemTotal">${(parseInt(item.sp.gia.replace(" VND", "").replace(".", "")) * item.qty).toLocaleString()}<sup>đ</sup></td>
                        <td><button class="removeBtn">X</button></td>
                    </tr>`;
    });

    // Chèn nội dung vào bảng
    document.querySelector("#tblCart").innerHTML = strHeader + strData;

    // Hàm tính toán tổng tiền
    function calculateTotal() {
        let total = 0;
        document.querySelectorAll(".itemTotal").forEach(item => {
            let itemPrice = parseInt(item.innerText.replace(" đ", "").replace(".", ""));
            total += itemPrice;
        });

        // Cập nhật tổng tiền trên giao diện
        document.querySelector(".cart-container-right table tr:nth-child(2) td:nth-child(2)").innerText = soluong;
        document.querySelector(".cart-container-right table tr:nth-child(3) td:nth-child(2) p").innerText = total.toLocaleString() + "đ";
        document.querySelector(".cart-container-right table tr:nth-child(4) td:nth-child(2) p").innerText = total.toLocaleString() + "đ";
        document.querySelector(".cart-container-right table tr:nth-child(5) td:nth-child(2) p").innerText = total.toLocaleString() + "đ";
    }

    // Gắn sự kiện cho việc thay đổi số lượng và chọn size
    document.querySelectorAll(".qtyInput").forEach(input => {
        input.addEventListener("change", function () {
            let row = this.closest("tr");
            let index = row.getAttribute("data-index");
            let qty = parseInt(this.value);
            arrCart[index].qty = qty;

            let price = parseInt(arrCart[index].sp.gia.replace(" VND", "").replace(".", ""));
            let itemTotal = price * qty;

            row.querySelector(".itemTotal").innerText = itemTotal.toLocaleString() + "đ";

            // Cập nhật giỏ hàng trong localStorage
            localStorage.setItem("myCart", JSON.stringify(arrCart));

            // Tính lại tổng tiền
            calculateTotal();
        });
    });

    // Xử lý sự kiện chọn size (nếu cần)
    document.querySelectorAll(".sizeSelect").forEach(select => {
        select.addEventListener("change", function () {
            let row = this.closest("tr");
            let index = row.getAttribute("data-index");
            let size = this.value;

            arrCart[index].size = size;

            // Cập nhật giỏ hàng trong localStorage
            localStorage.setItem("myCart", JSON.stringify(arrCart));
        });
    });

    // Gắn sự kiện cho nút xóa
    document.querySelectorAll(".removeBtn").forEach(button => {
        button.addEventListener("click", function () {
            let row = this.closest("tr");
            let index = row.getAttribute("data-index");

            // Xóa sản phẩm khỏi giỏ hàng
            arrCart.splice(index, 1);

            // Cập nhật giỏ hàng trong localStorage
            localStorage.setItem("myCart", JSON.stringify(arrCart));

            // Xóa hàng khỏi bảng
            row.remove();

            // Tính lại tổng tiền
            calculateTotal();
        });
    });

    // Thêm sản phẩm vào giỏ hàng
    function addToCart(product) {
        let existingIndex = arrCart.findIndex(item => item.sp.ten === product.sp.ten && item.size === product.size);

        if (existingIndex !== -1) {
            // Sản phẩm đã tồn tại, cập nhật số lượng
            arrCart[existingIndex].qty += product.qty;
        } else {
            // Sản phẩm không tồn tại, thêm mới
            arrCart.push(product);
        }

        // Cập nhật giỏ hàng trong localStorage
        localStorage.setItem("myCart", JSON.stringify(arrCart));

        // Cập nhật bảng giỏ hàng
        location.reload(); // Tải lại trang để cập nhật bảng giỏ hàng
    }
    let totalQuantity = 0;
if (Array.isArray(arrCart)) {
  arrCart.forEach(item => {
    if (typeof item.qty === 'number') {
      totalQuantity += item.qty;
    }
  });
}
    // Tính tổng tiền ban đầu khi trang được tải
    calculateTotal();
});


</script>

